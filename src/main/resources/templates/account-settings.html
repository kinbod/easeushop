<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="en">

<!-- Header Fragment -->
<head th:replace="fragments/header :: header(pageTitle='DBLOC IBS - Account Settings')"></head>

<body>
    <!-- Navigation Fragment -->
    <nav th:replace="fragments/navigation :: navigation"></nav>
    
    <div class="container" style="margin-top: 70px;">
    	<div class="row" sec:authorize="hasAuthority('ADMIN')">
            <div class="content-box">
		    	<div>
                    <div class="page-header">
                        <h3 class="text-center"><span>Account Settings</span></h3>
                    </div>
                </div>
                
                <div class="col-lg-12">
			    	<form id="change-password" class="form-horizontal" action="#" th:object="${member}" method="post">
			    		<h5>Account Information</h5>
			    		<div class="col-xs-12">
	                		<div class="col-xs-6">
			                    <div class="form-group">  
			                        <label class="control-label col-xs-4">Password</label>
			                        <div class="col-xs-8">
			                            <input type="password" th:field="*{newPassword}" class="form-control"/>
			                            <span class="help-inline" th:if="${#fields.hasErrors('newPassword')}" th:errors="*{newPassword}">error</span>
			                        </div>
			                    </div>
			                    <div class="form-group">  
			                        <label class="control-label col-xs-4">Confirm Password</label>
			                        <div class="col-xs-8">
			                            <input type="password" th:field="*{confirmPassword}" class="form-control"/>
			                            <span class="help-inline" th:if="${#fields.hasErrors('confirmPassword')}" th:errors="*{confirmPassword}">error</span>
			                        </div>
			                    </div>
			                    <span id="change-password-error" class="help-inline"></span>
		                    </div>
		                    <div class="col-xs-6">
		                    </div>
		                </div>
	                    <div class="col-xs-12">
	                    	<div class="col-xs-4"></div>
	                    	<button id="change-password-submit" type="button" class="btn gold-button col-xs-4">Change Password</button>
	                    	<div class="col-xs-4"></div>
	                   	</div>
			    	</form>
		    	</div>
                
                <div class="col-lg-12">
			    	<form id="change-basic-info" class="form-horizontal" action="#" th:object="${member}" method="post">
	               		<h5>Personal Information</h5>
	               		<div class="col-xs-6">
	               			<input type="hidden" th:field="*{birthdayValue}"/>
	               			<div class="form-group">  
		                        <label class="control-label col-xs-4">First Name</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{firstName}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Last Name</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{lastName}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Middle Initial</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{middleName}" class="form-control number"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('middleName')}" th:errors="*{middleName}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">
		                    	<label class="control-label col-xs-4">Birthday</label>
				                <div class="input-group date-group date col-xs-8">
				                    <input type="text" th:field="*{birthdayString}"  class="form-control" />
				                    <span class="input-group-addon calendar-button">
				                        <i class="fa fa-calendar"></i>
				                    </span>
				                    <span class="help-inline" th:if="${#fields.hasErrors('birthdayString')}" th:errors="*{birthdayString}">error</span>
				                </div>
				            </div>
				            <div class="form-group">  
		                        <label class="control-label col-xs-4">Age</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{age}" class="form-control number"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('age')}" th:errors="*{age}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Contact No.</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{contactNo}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('contactNo')}" th:errors="*{contactNo}">error</span>
		                        </div>
		                    </div>
	               		</div>
	               		<div class="col-xs-6">
	               			<div class="form-group">  
		                        <label class="control-label col-xs-4">Street Address</label>
		                        <div class="col-xs-8">
		                            <textarea rows="3" th:field="*{address}" class="form-control"></textarea>
		                            <span class="help-inline" th:if="${#fields.hasErrors('address')}" th:errors="*{address}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">City</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{city}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('city')}" th:errors="*{city}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Civil Status</label>
		                        <div class="col-xs-8">
		                            <select th:field="*{civilStatus}" class="form-control">
		                            	<option value=""></option>
		                            	<option value="Single">Single</option>
		                            	<option value="Married">Married</option>
		                            	<option value="Widowed">Widowed</option>
		                            	<option value="Separated">Separated</option>
		                            	<option value="Divorced">Divorced</option>
		                            	<option value="Other">Other</option>
		                            </select>
		                            <span class="help-inline" th:if="${#fields.hasErrors('civilStatus')}" th:errors="*{civilStatus}">error</span>
		                        </div>
		                    </div>
				            <div class="form-group">  
		                        <label class="control-label col-xs-4">TIN</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{tinNumber}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('tinNumber')}" th:errors="*{tinNumber}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Occupation</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{occupation}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('occupation')}" th:errors="*{occupation}">error</span>
		                        </div>
		                    </div>
	               		</div>
	               		<div class="col-xs-12">
	                    	<div class="col-xs-4"></div>
	                    	<button id="change-basic-info-submit" type="button" class="btn gold-button col-xs-4">Save Personal Information</button>
	                    	<div class="col-xs-4"></div>
	                   	</div>
		            </form>
	            </div>
	            
            </div>
		</div>
    </div>
    
    <div id="successful-message" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
        <div class="vertical-alignment-helper">
            <div class="modal-dialog vertical-align-center">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title text-center"><i class="fa fa-info-circle"></i><span id="successful-message-text"></span></h4>
                    </div>
                    <div class="modal-footer" style="text-align: center;">
                        <button data-dismiss="modal" class="btn btn-success">Okay</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Fragment -->
    <footer th:replace="fragments/footer :: footer"></footer>
    

    <script type="text/javascript">
	    $(document).ready(function() {
	    	$('body').tooltip({selector: '.edit-action, .remove-action'});
	    	
	    	if($('#birthdayValue').val() != '') {
    			$('#birthdayString').datetimepicker({
					format: "MM/DD/YYYY",
					defaultDate: new Date($('#birthdayValue').val())
				});
    		} else {
    			$('#birthdayString').datetimepicker({
					format: "MM/DD/YYYY"
				});
    		}
		}).on('click','#change-basic-info-submit',function() {
           var url = window.location.href + '/changeBasicInfo';
           $.ajax({
        	   	url : url,
				type : 'POST',
				dataType : 'json',
				data : $('#change-basic-info').serialize(),
				success : function(data) {
					if(data.success == true) {
						$('#successful-message-text').text(' Personal Information Successfully Saved');
						$('#successful-message').modal('show');
					}
				}
			});
		}).on('click','#change-password-submit',function() {
	           var url = window.location.href + '/changePassword';
	           $.ajax({
	        	   	url : url,
					type : 'POST',
					dataType : 'json',
					data : $('#change-password').serialize(),
					success : function(data) {
						$("#change-password-error").html("");
						if(data.success == true) {
							$('#successful-message-text').text(' Password Successfully Changed');
							$('#successful-message').modal('show');
						} else {
							if(data.errorList.length > 0) {
								$.each(data.errorList, function (i, val) {
				                    $("#change-password-error").append("<span>" + val +"</span>");
				                });
							}
						}
					}
				});
			}).on('click', '.calendar-button', function() {
			$(this).siblings('input').trigger('focus');
		});
    </script>

</body>

</html>